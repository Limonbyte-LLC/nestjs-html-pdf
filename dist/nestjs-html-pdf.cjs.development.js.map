{"version":3,"file":"nestjs-html-pdf.cjs.development.js","sources":["../src/index.ts"],"sourcesContent":["const puppeteer = require('puppeteer');\nconst hbs = require('handlebars')\nconst fs = require('fs-extra')\n\nexport const createPdf = async (filePath: string, options = {}, data = {}) => {\n  try {\n    const browser = await puppeteer.launch({ args: ['--no-sandbox'] });\n    const page = await browser.newPage();\n    \n    hbs.registerHelper(\"ifCond\", function (\n        v1: any, \n        operator: any, \n        v2: any, \n        options:any\n      ) {\n      switch (operator) {\n        case \"==\":\n          return v1 == v2 ? options.fn(data) : options.inverse(data);\n        case \"===\":\n          return v1 === v2 ? options.fn(data) : options.inverse(data);\n        case \"!=\":\n          return v1 != v2 ? options.fn(data) : options.inverse(data);\n        case \"!==\":\n          return v1 !== v2 ? options.fn(data) : options.inverse(data);\n        case \"<\":\n          return v1 < v2 ? options.fn(data) : options.inverse(data);\n        case \"<=\":\n          return v1 <= v2 ? options.fn(data) : options.inverse(data);\n        case \">\":\n          return v1 > v2 ? options.fn(data) : options.inverse(data);\n        case \">=\":\n          return v1 >= v2 ? options.fn(data) : options.inverse(data);\n        case \"&&\":\n          return v1 && v2 ? options.fn(data) : options.inverse(data);\n        case \"||\":\n          return v1 || v2 ? options.fn(data) : options.inverse(data);\n        default:\n          return options.inverse(options);\n      }\n    });\n\n    hbs.registerHelper({\n      eq: (v1: any, v2: any) => v1 === v2,\n      ne: (v1: any, v2: any) => v1 !== v2,\n      lt: (v1: number, v2: number) => v1 < v2,\n      gt: (v1: number, v2: number) => v1 > v2,\n      lte: (v1: number, v2: number) => v1 <= v2,\n      gte: (v1: number, v2: number) => v1 >= v2,\n      and() {\n          return Array.prototype.every.call(arguments, Boolean);\n      },\n      or() {\n          return Array.prototype.slice.call(arguments, 0, -1).some(Boolean);\n      }\n    });\n    \n    const html = await fs.readFile(filePath, 'utf8');\n    const content = hbs.compile(html)(data);\n    await page.setContent(content);\n\n    const buffer = await page.pdf({\n      // path: 'output-abc.pdf',\n      format: 'a4',\n      printBackground: true,\n      margin: {\n        left: '10mm',\n        top: '10mm',\n        right: '10mm',\n        bottom: '10mm',\n      },\n      ...options,\n    });\n    await browser.close();\n    // process.exit();\n    return buffer;\n    } catch (e) {\n    console.log(e);\n    }\n};\n"],"names":["puppeteer","require","hbs","fs","createPdf","filePath","options","data","launch","browser","newPage","page","registerHelper","v1","operator","v2","fn","inverse","eq","ne","lt","gt","lte","gte","and","Array","prototype","every","call","arguments","Boolean","or","slice","some","readFile","html","content","compile","setContent","pdf","format","printBackground","margin","left","top","right","bottom","buffer","close","console","log"],"mappings":"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"}